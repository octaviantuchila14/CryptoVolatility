<p id="notice"><%= notice %></p>

<p>
  Create new portfolio
</p>

<p>
  <strong>Start date:</strong>
  <%= @portfolio.start_date %>
</p>

<p>
  <strong>End date:</strong>
  <%= @portfolio.end_date %>
</p>

<p>
  <strong>Portfolio maximum return:</strong>
  <%= @portfolio.max_return %>
</p>

<div id="return_p" >
    <%=form_for @portfolio do |f| %>
          <% if @portfolio.errors.any? %>
              <div id="error_explanation">
                <h2><%= pluralize(@portfolio.errors.count, "error") %> prohibited this portfolio from being saved:</h2>
                <ul>
                  <% @portfolio.errors.full_messages.each do |message| %>
                      <li><%= message %></li>
                  <% end %>
                </ul>
              </div>
          <% end %>
        <%= f.label "Portfolio Return" %>
        <%= f.number_field(:p_return, id:"return_number") %>
        <%= f.submit "Obtain optimal portfolio", class: "btn btn-primary" %>
    <% end %>
</div>

<div id="computed_portfolio">
  <% if(@portfolio.p_return != nil && @portfolio.p_return.between?(0, @portfolio.max_return)) %>
      <strong>Optimal Variance:</strong>
      <%= @portfolio.variance %>
      <strong>Our portfolio will have the following currencies with their respective weights</strong>

      <% weights = @portfolio.compute_weights %>

      <table id="wt">
        <tr>
          <th>Currency</th>
          <th>Weight</th>
        </tr>
        <% @portfolio.currencies.each do |cr| %>
            <tr>
              <td class="full_name"><%= cr.full_name %></td>
              <td class="weight"><%= number_to_percentage(weights[cr] * 100) %></td>
            </tr>
        <% end %>
      </table>
    <% end %>
</div>


<%= link_to 'Edit', edit_portfolio_path(@portfolio) %> |
<%= link_to 'Back', portfolios_path %>
